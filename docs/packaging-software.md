# –ß—Ç–æ —Ç–∞–∫–æ–µ RPM-–ø–∞–∫–µ—Ç?

RPM-–ø–∞–∫–µ—Ç - —ç—Ç–æ –∞—Ä—Ö–∏–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤ —Å–µ–±–µ –∞—Ä—Ö–∏–≤ [.cpio](https://en.wikipedia.org/wiki/Cpio) —Å —Ñ–∞–π–ª–∞–º–∏, –∞ —Ç–∞–∫–∂–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ - –∏–º—è –ø–∞–∫–µ—Ç–∞, –µ–≥–æ –æ–ø–∏—Å–∞–Ω–∏–µ, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Ç.–¥. –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–æ–≤ RPM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤ –∏–∑ —Å–ø–∏—Å–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ —Ñ–∞–π–ª–æ–≤ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–∞–∫–µ—Ç–µ —É —Å–µ–±—è –≤ –±–∞–∑–µ. 

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ RPM-–ø–∞–∫–µ—Ç–æ–≤:

* SRPM-–ø–∞–∫–µ—Ç—ã (–∏—Å—Ö–æ–¥–Ω–∏–∫–∏) - –∞—Ä—Ö–∏–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.src.rpm`. SRPM —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∞—Ç—á–∏ –∫ –Ω–µ–º—É –∏ spec-—Ñ–∞–π–ª, –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è, –∫–∞–∫ —Å–æ–±—Ä–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –≤ RPM-–ø–∞–∫–µ—Ç.
* RPM-–ø–∞–∫–µ—Ç—ã - –∞—Ä—Ö–∏–≤ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `.rpm`. RPM —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–±–æ—Ä–∫–µ RPM-–ø–∞–∫–µ—Ç–æ–≤

–ü–∞–∫–µ—Ç ``rpmdevtools``, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –Ω–∞ —ç—Ç–∞–ø–µ [–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã](#prerequisites), –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —É—Ç–∏–ª–∏—Ç, —É–ø—Ä–æ—â–∞—é—â–∏–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ —Å–±–æ—Ä–∫–µ RPM-–ø–∞–∫–µ—Ç–æ–≤. –ß—Ç–æ–±—ã –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å —ç—Ç–∏ —É—Ç–∏–ª–∏—Ç—ã, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É:

```bash
$ rpm -ql rpmdevtools | grep bin

/usr/bin/rpmdev-bumpspec
/usr/bin/rpmdev-checksig
/usr/bin/rpmdev-cksum
/usr/bin/rpmdev-diff
/usr/bin/rpmdev-extract
/usr/bin/rpmdev-md5
/usr/bin/rpmdev-newinit
/usr/bin/rpmdev-newspec
/usr/bin/rpmdev-packager
/usr/bin/rpmdev-rmdevelrpms
/usr/bin/rpmdev-setuptree
/usr/bin/rpmdev-sha1
/usr/bin/rpmdev-sha224
/usr/bin/rpmdev-sha256
/usr/bin/rpmdev-sha384
/usr/bin/rpmdev-sha512
/usr/bin/rpmdev-sort
/usr/bin/rpmdev-sum
/usr/bin/rpmdev-vercmp
/usr/bin/rpmdev-wipetree
/usr/bin/rpminfo
/usr/bin/rpmls

```

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç–∞—Ö —Å–º. –∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –∏–ª–∏ –¥–∏–∞–ª–æ–≥–æ–≤—ã–µ –æ–∫–Ω–∞ —Å–ø—Ä–∞–≤–∫–∏.

## –†–∞–±–æ—á–µ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Å–±–æ—Ä–∫–∏ RPM-–ø–∞–∫–µ—Ç–æ–≤
–ß—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –¥–µ—Ä–µ–≤–æ –∫–∞—Ç–∞–ª–æ–≥–æ–≤, –∫–æ—Ç–æ—Ä–æ–µ —è–≤–ª—è–µ—Ç—Å—è —Ä–∞–±–æ—á–µ–π –æ–±–ª–∞—Å—Ç—å—é —Å–±–æ—Ä–∫–∏ RPM-–ø–∞–∫–µ—Ç–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É—Ç–∏–ª–∏—Ç—É ``rpmdev-setuptree``, –∏–ª–∏ –∂–µ —Å–æ–∑–¥–∞–π—Ç–µ –∫–∞—Ç–∞–ª–æ–≥–∏ –≤—Ä—É—á–Ω—É—é, –∏—Å–ø–æ–ª—å–∑—É—è —É—Ç–∏–ª–∏—Ç—É `mkdir`:

```bash
$ rpmdev-setuptree

$ tree ~/rpmbuild/
/home/user/rpmbuild/
|-- BUILD
|-- RPMS
|-- SOURCES
|-- SPECS
 -- SRPMS

```

–û–ø–∏—Å–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–∞–ª–æ–≥–æ–≤:


| –ö–∞—Ç–∞–ª–æ–≥       | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ        |
|:------------- |:----------------- |
| BUILD         | –°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ –ø–∞–∫–µ—Ç–∞. |
| RPMS          | –ó–¥–µ—Å—å —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —Å–æ–±—Ä–∞–Ω–Ω—ã–µ RPM-–ø–∞–∫–µ—Ç—ã (`.rpm`) –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞—Ö –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∞—Ö``x86_64`` –∏ ``noarch``. |
| SOURCES       | –ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∞—Ä—Ö–∏–≤—ã –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞ –∏ –ø–∞—Ç—á–∏. –£—Ç–∏–ª–∏—Ç–∞ ``rpmbuild`` –∏—â–µ—Ç –∏—Ö –∑–¥–µ—Å—å. |
| SPECS         | –ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è spec-—Ñ–∞–π–ª—ã. |
| SRPMS         | –ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø–∞–∫–µ—Ç—ã —Å –∏—Å—Ö–æ–¥–Ω–∏–∫–∞–º–∏ (`.src.rpm`). |

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –ø–µ—Ä–µ–π–¥—ë–º –≤ —Ñ–∞–π–ª `~/home/.rpmmacros`. –í –Ω—ë–º —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è —Å–ª–µ–¥—É—é—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

* –ú–µ—Å—Ç–æ—Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –¥–ª—è —Å–±–æ—Ä–∫–∏;
* –ö–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –ø–∞–∫–µ—Ç–æ–≤;
* –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ–ª—è _Packager_

```
%_topdir<------>%homedir/RPM
#%_tmppath<---->%homedir/tmp

# %packager<--->Joe Hacker <joe@email.address>
# %_gpg_name<-->joe@email.address
```

–†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø–æ–ª–µ _Packager_: –í–ø–∏—à–∏—Ç–µ —Å–≤–æ—ë –∏–º—è, —Ñ–∞–º–∏–ª–∏—é –∏ –ø–æ—á—Ç—É. –ü–æ–ª–µ —Å –∫–ª—é—á—ë–º –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –í—ã –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–∑–∂–µ. –û —Ç–æ–º, –∫–∞–∫ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–ª—é—á–∏, –í—ã —É–∑–Ω–∞–µ—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª–µ [–°–æ–∑–¥–∞–Ω–∏–µ SSH –∏ GPG –∫–ª—é—á–µ–π](#JoinKey).

**üìå NOTE**\
–î–µ–π—Å—Ç–≤–∏—è, –æ–ø–∏—Å–∞–Ω–Ω—ã–µ –Ω–∏–∂–µ, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏, –æ–Ω–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é! 

–ò—Ç–∞–∫, –µ—Å–ª–∏ –í—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —É—Ç–∏–ª–∏—Ç–æ–π `rpmdev-setuptree`, –∞ –Ω–µ —Å–æ–∑–¥–∞–ª–∏ –¥–µ—Ä–µ–≤–æ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –≤—Ä—É—á–Ω—É—é, –æ–±—Ä–∞—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ñ–∞–π–ª `~/home/.rpmmacros`:

```
%_topdir<------>%homedir/RPM
#%_tmppath<---->%homedir/tmp

%packager<--->Joe Hacker <joe@email.address>
# %_gpg_name<-->joe@email.address

%__arch_install_post \
    [ "%{buildarch}" = "noarch" ] || QA_CHECK_RPATHS=1 ; \
    case "${QA_CHECK_RPATHS:-}" in [1yY]*) /usr/lib/rpm/check-rpaths ;; esac \
    /usr/lib/rpm/check-buildroot

```

–í —Ñ–∞–π–ª–µ –ø–æ—è–≤–∏–ª–∞—Å—å —Å–µ–∫—Ü–∏—è `%__arch_install_post`. –î–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–¥–∞–ª–∏—Ç—å, –≤–µ—Ä–Ω—É–≤ —Ñ–∞–π–ª –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é, –∏–Ω–∞—á–µ –ø—Ä–æ—Ü–µ—Å—Å —Å–±–æ—Ä–∫–∏ –±—É–¥–µ—Ç –∑–∞–≤–µ—Ä—à–∞—Ç—å—Å—è —Å –æ—à–∏–±–∫–æ–π. 

```
%_topdir<------>%homedir/RPM
#%_tmppath<---->%homedir/tmp

%packager<--->Valentin Sokolov <sova@altlinux.org>
# %_gpg_name<-->joe@email.address
```
